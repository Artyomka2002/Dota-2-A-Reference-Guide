var __spreadArray,CoreUtilities,LoggerModule,VisibilityChangeHelperModule,HitHighlightingParserImpl,DataSourceLayoutManager,ThresholdDiagnosticsProd,FailedPromise,ThresholdUtilitiesM2;_w.EventsToDuplicate=[];_w.useSharedLocalStorage=!1;define("shared",["require","exports"],function(n,t){function s(n,t){for(var r=n.length,i=0;i<r;i++)t(n[i])}function r(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return function(){n.apply(null,i)}}function u(n){i&&event&&(event.returnValue=!1);n&&typeof n.preventDefault=="function"&&n.preventDefault()}function f(n){i&&event&&(event.cancelBubble=!0);n&&typeof n.stopPropagation=="function"&&n.stopPropagation()}function e(n,t,i){for(var r=0;n&&n.offsetParent&&n!=(i||document.body);)r+=n["offset"+t],n=n.offsetParent;return r}function o(){return(new Date).getTime()}function h(n){return i?event:n}function c(n){return i?event?event.srcElement:null:n.target}function l(n){return i?event?event.fromElement:null:n.relatedTarget}function a(n){return i?event?event.toElement:null:n.relatedTarget}function v(n,t,i){while(n&&n!=(i||document.body)){if(n==t)return!0;n=n.parentNode}return!1}function y(n){window.location.href=n}function p(n,t){n&&(n.style.filter=t>=100?"":"alpha(opacity="+t+")",n.style.opacity=t/100)}t.__esModule=!0;t.getTime=t.getOffset=t.stopPropagation=t.preventDefault=t.wrap=t.forEach=void 0;var i=sb_ie;t.forEach=s;t.wrap=r;t.preventDefault=u;t.stopPropagation=f;t.getOffset=e;t.getTime=o;window.sj_b=document.body;window.sb_de=document.documentElement;window.sj_wf=r;window.sj_pd=u;window.sj_sp=f;window.sj_go=e;window.sj_ev=h;window.sj_et=c;window.sj_mi=l;window.sj_mo=a;window.sj_we=v;window.sb_gt=o;window.sj_so=p;window.sj_lc=y});define("env",["require","exports","shared"],function(n,t,i){function v(n,t){return t.length&&typeof n=="function"?function(){return n.apply(null,t)}:n}function y(n,t){var e=[].slice.apply(arguments).slice(2),i=v(n,e),u;return typeof i=="function"&&(u=window.setImmediate&&!window.setImmediate.Override&&(!t||t<=16)?"i"+setImmediate(i):o(i,t),f[r]=u,r=(r+1)%a),u}function p(n,t){var r=[].slice.apply(arguments).slice(2),i=l(v(n,r),t);return e[u]=i,u=(u+1)%a,i}function w(){h.forEach(f,s);h.forEach(e,window.clearInterval);r=u=e.length=f.length=0}function s(n){n!=null&&(typeof n=="string"&&n.indexOf("i")===0?window.clearImmediate(parseInt(n.substr(1),10)):c(n))}var h=i,f=[],e=[],o,c,l,a=1024,r=0,u=0;o=window.setTimeout;t.setTimeout=y;l=window.setInterval;t.setInterval=p;t.clear=w;c=window.clearTimeout;t.clearTimeout=s;window.sb_rst=o;window.setTimeout=window.sb_st=y;window.setInterval=window.sb_si=p;window.clearTimeout=window.sb_ct=s});
/*!DisableJavascriptProfiler*/
define("event.custom",["require","exports","shared","env"],function(n,t,i,r){function f(n){return u[n]||(u[n]=[])}function e(n,t){n.d?l.setTimeout(c.wrap(n,t),n.d):n(t)}function v(n,t,i){var r,f;for(r in u)f=i?t&&r.indexOf(t)===0:!(r.indexOf(a)===0)&&!(t&&r.indexOf(t)===0)&&!(n!=null&&n[r]!=null),f&&delete u[r]}function o(n){for(var t=f(n),u=t.e=arguments,i,r=0;r<t.length;r++)if(t[r].alive)try{e(t[r].func,u)}catch(o){i||(i=o)}if(i)throw i;}function s(n,t,i,r){var u=f(n);t&&(t.d=r,u.push({func:t,alive:!0}),i&&u.e&&e(t,u.e))}function h(n,t){for(var i=0,r=u[n];r&&i<r.length;i++)if(r[i].func==t&&r[i].alive){r[i].alive=!1;break}}var c=i,l=r,u={},a="ajax.";t.reset=v;t.fire=o;t.bind=s;t.unbind=h;_w.sj_evt={bind:s,unbind:h,fire:o}});define("event.native",["require","exports"],function(n,t){function r(n,t,r,u){var f=n===window||n===document||n===document.body;n&&(f&&t=="load"?i.bind("onP1",r,!0):f&&t=="unload"?i.bind("unload",r,!0):n.addEventListener?n.addEventListener(t,r,u):n.attachEvent?n.attachEvent("on"+t,r):n["on"+t]=r)}function u(n,t,r,u){var f=n===window||n===document||n===document.body;n&&(f&&t=="load"?i.unbind("onP1",r):f&&t=="unload"?i.unbind("unload",r):n.removeEventListener?n.removeEventListener(t,r,u):n.detachEvent?n.detachEvent("on"+t,r):n["on"+t]=null)}t.__esModule=!0;t.unbind=t.bind=void 0;var i=n("event.custom");t.bind=r;t.unbind=u;window.sj_be=r;window.sj_ue=u});define("dom",["require","exports"],function(n,t){function f(n,t){function s(n,t,r,f){r&&u.unbind(r,f,s);c.bind("onP1",function(){if(!n.l){n.l=1;var r=i("script");r.setAttribute("data-rms","1");r.src=(t?"/fd/sa/"+_G.Ver:"/sa/"+_G.AppVer)+"/"+n.n+".js";_d.body.appendChild(r)}},!0,5)}for(var f=arguments,e,o,r=2,l={n:n};r<f.length;r+=2)e=f[r],o=f[r+1],u.bind(e,o,h.wrap(s,l,t,e,o));r<3&&s(l,t)}function e(){var n=_d.getElementById("ajaxStyles");return n||(n=_d.createElement("div"),n.id="ajaxStyles",_d.body.insertBefore(n,_d.body.firstChild)),n}function l(n){var t=i("script");t.type="text/javascript";t.text=n;t.setAttribute("data-bing-script","1");document.body.appendChild(t);r.setTimeout(function(){document.body.removeChild(t)},0)}function a(n){var t=document.querySelector('script[type="importmap"]');t?t.text=n:(t=i("script"),t.type="importmap",t.text=n,document.body.appendChild(t),r.setTimeout(function(){document.body.removeChild(t)},0))}function v(n){var t=i("script");t.type="text/javascript";t.src=n;t.setAttribute("crossorigin","anonymous");t.onload=r.setTimeout(function(){document.body.removeChild(t)},0);document.body.appendChild(t)}function o(n){var t=s("ajaxStyle");t||(t=i("style"),t.setAttribute("data-rms","1"),t.id="ajaxStyle",e().appendChild(t));t.textContent!==undefined?t.textContent+=n:t.styleSheet.cssText+=n}function y(n,t){for(var i=Element.prototype,r=i.matches||i.msMatchesSelector;n!=null;){if(r.call(n,t))return n;n=n.parentElement}return null}function s(n){return _d.getElementById(n)}function i(n,t,i){var r=_d.createElement(n);return t&&(r.id=t),i&&(r.className=i),r}t.__esModule=!0;t.includeCss=t.includeScriptReference=t.includeImportMapScript=t.includeScript=t.getCssHolder=t.loadJS=void 0;var r=n("env"),h=n("shared"),u=n("event.native"),c=n("event.custom");t.loadJS=f;t.getCssHolder=e;t.includeScript=l;t.includeImportMapScript=a;t.includeScriptReference=v;t.includeCss=o;_w._ge=s;_w.sj_ce=i;_w.sj_jb=f;_w.sj_ic=o;_w.sj_fa=y});define("cookies",["require","exports"],function(n,t){function u(n,t){var i=a[n];return i&&(!t||i.length==0||i.indexOf(t)>=0)}function b(){var n=location.protocol==="https:";return n?";secure":""}function k(){return typeof _G!="undefined"&&_G.EF!==undefined&&_G.EF.cookss!==undefined&&_G.EF.cookss===1}function f(){var n=location.hostname.match(/([^.]+\.[^.]*)$/);return n?";domain="+n[0]:""}function e(n,t,i,r,u){var s=f(),h=r&&r>0&&r*6e4<33696e6?r*6e4:33696e6,c=new Date((new Date).getTime()+Math.min(h,33696e6)),e="",o;k()&&(o=b(),e=o+(u?";SameSite="+u:";SameSite=None"));document.cookie=n+s+(t?";expires="+c.toGMTString():"")+(i?";path="+i:"")+e}function o(){return!i}function r(n,t){var r,f;if(i||!u(n,t))throw new Error("get cookie unauthorized");return(r=document.cookie.match(new RegExp("\\b"+n+"=[^;]+")),t&&r)?(f=r[0].match(new RegExp("\\b"+t+"=([^&]*)")),f?f[1]:null):r?r[0]:null}function s(n,t,f,o,s,h){var a,c,l,v;if(i||!u(n,t))throw new Error("set cookie unauthorized");c=t+"="+f;l=r(n);l?(v=r(n,t),a=v!==null?l.replace(t+"="+v,c):l+"&"+c):a=n+"="+c;e(a,o,s,h)}function h(n,t,r,f,o){if(i||!u(n))throw new Error("set cookie unauthorized");var s=n+"="+t;e(s,r,f,o)}function c(n,t){if(!i){var r=n+"=",u=f();document.cookie=r+u+";expires="+v+(t?";path="+t:"")}}function l(){var r=null,e,n,u,t,f;if(!i)for(r={},e=document.cookie;n=y.exec(e);){for(t={},f=!1;u=p.exec(n[2]);)f=!0,t[u[1]]=u[2];f||(t=n[2]);r[n[1]]=t}return r}var w;t.__esModule=!0;t.parse=t.clear=t.setNoCrumbs=t.set=t.get=t.areCookiesAccessible=void 0;var a={MUID:[],_SS:["SID","CPID","AC","CPH","CBV","fldcp"],SRCHHPGUSR:["LUT","IAC","IPMH","HV","DPR","SRCHLANG"],RMS:[]},i=!1,v=new Date(0).toGMTString(),y=new RegExp("([^=]+)=([^;]*)(; )?","g"),p=new RegExp("([^=]+)=([^&]*)&?","g");try{w=document.cookie}catch(d){i=!0}t.areCookiesAccessible=o;t.get=r;t.set=s;t.setNoCrumbs=h;t.clear=c;t.parse=l;window.sj_cook={get:r,set:s,setNoCrumbs:h,clear:c,parse:l,areCookiesAccessible:o}});define("rmsajax",["require","exports"],function(n,t){function a(){for(var i,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(n.length!=0){if(i=n[n.length-1],n.length==1)ct(i)&&f.push(i);else                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ut(){r.dumpToStorage();at(!1)}function gi(){r.dumpToStorage(!0)}function wt(){r.dumpToStorage()}function nr(){b=null;_CachedFlights=undefined}var r,c,it,yi,pi,wi,rt;t.__esModule=!0;t.ResetState=t.SaveLogsToLocalStorage=t.SaveLogsToSharedStorage=t.FlushMainQueueDontForce=t.ForceFlush=t.Log2=t.LogInstrumented=t.Log=t.LogMasterPageImpressionWSB=t.LogMasterPageImpression=t.LogEvent=t.SetOnInstrumentDone=t.SetFeatures=void 0;var ft=n("env"),et=n("event.native"),h=n("event.custom"),o="Shared",s;(function(n){n[n.EVENT=0]="EVENT";n[n.MASTER_PAGE_IMPRESSION=1]="MASTER_PAGE_IMPRESSION"})(s||(s={}));var w="MUID",b=null,ot="CIQueueError",i,tr=864e5,st,k,e,ht=[],ct=[],f,v,bt,kt=0,ir=typeof _G=="object"&&_G.RevIpCC&&_G.RevIpCC.toUpperCase()||"",y=ir=="CN"?"https://cn.bing.com":"https://www.bing.com";(function(n){function p(){return o&&i.isInstrumentationEnabled}function w(n){var u,i;if(n===void 0&&(n=!1),p()){u=st(n);try{i=n?c:f;e[i]=u;e[i+"_logUploadIntervalStartDate"]=r;e[i+"_uploadedLogSizeInInterval"]=t}catch(s){if(s.name.toLowerCase().indexOf("quota")>=0)o=!1;else throw s;}}}function l(){p()&&(h&&sb_ct(h),h=sb_st(w,i.queueDumpInterval))}function g(n,t){var i=JSON.stringify(n),r=i.length+3;return n.size=r,t?i.replace('"size":0','"size":'+r):i}function nt(n){return b===null&&typeof _CachedFlights!="undefined"&&_CachedFlights.sort&&(b=_CachedFlights.sort().join(",")),{log:n,lastSendErrorTimeStamp:0,inProgress:!1,size:0,flights:b}}function tt(){var t,r,i;if(e){if(ct(),t=e[f],n.queue=[],typeof t=="string"||t&&t.length!==0)try{if(n.queue=JSON.parse(t),n.queue.some(function(n){return!n.log}))u("PrimaryQueueRestoreInvalidItems",n.queue.length,_G.IG),n.queue=[];else if(r=n.queue.length,r>0){for(i=0;i<r;i++)n.queue[i].inProgress=!1;at(!0)}}catch(s){u("PrimaryQueueRestoreFailed",0,_G.IG)}e[f]="[]";o=!0}}function it(t){var a=[],v=[],f=t?n.retryList[0]:n.queue,h,o,y,p,l,r,w;if(d){if(h=e[c],typeof h=="string"&&h.length!==0)try{o=JSON.parse(h);o.some(function(n){return!n.log})?u("SharedQueueRestoreInvalidItems",o.length,_G.IG):f?Array.prototype.push.apply(f,o):f=o}catch(b){u("SharedQueueRestoreFailed",0,_G.IG)}e[c]="[]"}if(f)for(y=0,p=f.length,l=0;l<p;l++)if(r=f[l],t||!r.lastSendErrorTimeStamp)if(ClientInstConfig.enableBatSizeError&&r.size>i.maxBatchSize&&u("ElemBatchSizeLimitReached",r.size,_G.IG),y+=r.size,y<=i.maxBatchSize)r.inProgress=!0,w=r.log,w.type==s.MASTER_PAGE_IMPRESSION?v.push(r):a.push(r);else break;return{events:a,masterPageImpressions:v,length:a.length+v.length,isRetryBatch:t}}function rt(t){return n.queue=n.queue.filter(function(n){return!n.inProgress&&(!t||!!n.lastSendErrorTimeStamp)}),l(),n.queue.length>0}function ut(n){return n.log.type===s.EVENT&&n.log.data&&n.log.data.eventType===ot}function ft(t,i){for(var f=[],s=i?n.retryList[0]:n.queue,e=0,r,o,h;e<s.length;)r=s[e],r.inProgress?t?(s.splice(e,1),ut(r)||(r.lastSendErrorTimeStamp=(new Date).getTime(),f.push(r))):(r.inProgress=!1,e++):e++;o=f.length;o==1?u("InvalidLogMessage",1,f[0].log.impressionGuid):o>0&&(h=o/2,n.retryList.push(f.slice(0,h)),n.retryList.push(f.slice(h)));l()}function et(){var t,i,r;if(n.retryList.length>0){for(t=n.retryList[0],i=0;i<t.length;)r=t[i],r.inProgress?t.splice(i,1):i++;t.length==0&&n.retryList.shift()}}function st(t){var c=JSON.stringify(n.queue),f=c.length-i.maxStorageUse,e,o,r,s,h;if(v=0-f,e=n.queue.length,f>0)for(o=0,r=0;r<e;r++)if(s=n.queue[r].size,o+=s+1,o>=f){n.queue.splice(0,r+1);u("QueueOverflow",r+1,_G.IG,!0);break}return h=JSON.stringify(n.queue),t&&n.queue.splice(0,e),h}function ht(t){var r=nt(t);g(r,!1);ClientInstConfig.enableBatSizeError&&r.size>i.maxBatchSize&&u("EnvelopeBatchSizeLimitReached:"+t.type,r.size,_G.IG,undefined);r.size>i.maxBatchSize?u("LogObjectTooLarge",1,_G.IG,!0):lt(r.size)&&(i.optimizeFlush?v>=r.size?n.queue.push(r):u("QueueFullDropLog",1,_G.IG,!0):n.queue.push(r));l()}function ct(){var u=f+"_logUploadIntervalStartDate",o=f+"_uploadedLogSizeInInterval",n;r=e[u];t=e[o];n=sb_gt();r==undefined||t==undefined?a(n):k(r,n)>=i.logUploadCapIntervalInDays&&a(n)}function a(n){r=n;t=0}function k(n,t){var i=t-n;return i/tr}function lt(n){var f,e;return i.isInstrumentationEnabled?LogUploadCapFeatureEnabled?(f=sb_gt(),k(r,f)>=i.logUploadCapIntervalInDays&&a(f),t>=i.logUploadCapSizeInChar)?!1:(e=t+n,e>=i.logUploadCapSizeInChar)?(u("LogUploadSizeLimitReached",1,_G.IG,!0),t=i.logUploadCapSizeInChar,!1):(t=e,!0):!0:!1}n.queue=[];var r,t,o=!1,h=null,v=5e5;n.retryList=[];var y=_w.location.pathname,f=InstLogQueueKeyFetcher.Get(y),c=InstLogQueueKeyFetcher.GetSharedLocation(),d=InstLogQueueKeyFetcher.CanUploadSharedMessages(y);n.dumpToStorage=w;n.initialize=tt;n.getBatch=it;n.clearSentItems=rt;n.markFailedItems=ft;n.recordRetryAttempt=et;n.append=ht})(r||(r={}));var gt=0,ni=0,ti=0,ii=0,ri=0,d="";t.SetFeatures=ui;c={mainQueue:{getInterval:function(){return i.flushInterval}},retryQueue:{getInterval:function(){return i.retryInterval}}};it="";t.SetOnInstrumentDone=li;t.LogEvent=yt;t.LogMasterPageImpression=ai;t.LogMasterPageImpressionWSB=vi;yi=function(n,t,r,u){for(var e=[],f=4;f<arguments.length;f++)e[f-4]=arguments[f];i.isInstrumentationEnabled&&(bt||(rt("Init","CI","Base"),bt=!0),rt(n,t,r,u,e))};t.Log=yi;pi=function(n,i,r,u,f,e,o){t.Log2(n,i!==null&&i!==void 0?i:r,null,null,u,f,o)};t.LogInstrumented=pi;wi=function(n,t,i,r,u,f,e){var o=Object.keys(e).reduce(function(n,t){return __spreadArray(__spreadArray([],n,!0),[t,e[t]],!1)},[]);i&&o.push("service",i);r&&o.push("scenario",r);u&&o.push("appNS",u);f&&o.push("kValue",f);rt(n,null,t,!1,o)};t.Log2=wi;rt=function(n,t,r,u,f){var a,e,c,l,o,h,v;if(i.isInstrumentationEnabled){if(a=_G.IG,e={},f&&f.length>0&&f.length%2==0)for(c=0;c<f.length;c+=2)(l=f[c],l)&&(o=l.toLowerCase(),h=f[c+1],o==="impressionguid"?a=h:o==="service"?e.Service=h:o==="scenario"?e.Scenario=h:o==="appns"?e.AppNS=h:o==="k"||o==="kvalue"?e.K=h:o==="pos"?e.Pos=h:e[l]=h);v=(new Date).getTime();e.T="CI.".concat(n);e.TS=v;e.RTS=v-k;e.SEQ=st++;e.Name=r!==null&&r!==void 0?r:"";e.FID=typeof t!="number"?t!==null&&t!==void 0?t:"":"";e.hasOwnProperty("K")||typeof t!="number"||(e.K=t);p(e);g({type:s.EVENT,impressionGuid:a,previousImpressionGuid:null,timestamp:k,data:{eventType:"ClientInst",eventData:e}})}};t.ForceFlush=di;ur();t.FlushMainQueueDontForce=ut;t.SaveLogsToSharedStorage=gi;t.SaveLogsToLocalStorage=wt;t.ResetState=nr;typeof h!="undefined"&&h.bind&&(h.bind("onP1",ut,!0),h.bind("ajax.postload",ut,!0));typeof et!="undefined"&&et.bind&&et.bind(_w,"beforeunload",wt,!1);_w.Log={Log:t.Log};_w.Log2={LogEvent:yt,LogMasterPageImpression:ai,LogMasterPageImpressionWSB:vi,ForceFlush:di,FlushMainQueueDontForce:ut,SaveLogsToSharedStorage:gi,ResetState:nr,SaveLogsToLocalStorage:wt,SetOnInstrumentDone:li,SetFeatures:ui};_w.Shared2=_w.Shared2||{};_w.Shared2.Log={Log:t.Log,LogInstrumented:t.LogInstrumented};_w.sj_log2=t.Log2}),function(n){function i(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return t.apply(null,[null,n].concat(r))}function t(n,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return function(){for(var f,r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];if(r&&r.length!==0)for(f in i)i.hasOwnProperty(f)&&r.push(i[f]);else r=i;return t.apply(n,r)}}function r(){for(var n,r,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(n=t[0],r=1;r<t.length;r++)if(n)n=n[t[r]];else return null;return n}n.deferFunction=i;n.deferMethod=t;n.getProperty=r;window.sj_df=i;window.sj_dm=t;window.sj_gp=r}(CoreUtilities||(CoreUtilities={})),function(n){function v(n,i,r,o,s){(new Image).src=_G.lsUrl+'&Type=Event.ClientInst&DATA=[{"T":"CI.Error","FID":"CI","Name":"JSError","Text":'+n+"}]";u(t.Error,f,e,n,i,r,o,s)}function y(n,i,r,o,s){u(t.Error,f,e,n,i,r,o,s)}function p(n,i,r){u(t.Warning,l,a,n,i,r)}function w(n){r=n}function u(n,u,f,e,o,h,c,l){var w="Error",d=n+e,v=u[d],g,a,p,y;(typeof v!="number"&&(v=0),r(h,e))||(g=e.substr(0,7)=="http://"||e.substr(0,8)=="https://"?"":e,!h&&o&&(h=o,o=undefined),a={Text:null,Stack:null,Meta:_w.location.href,Line:c,Char:l,Name:"JSError"},Object.defineProperty(a,"Text",{get:sj_df(b,a,g,o,n,h)}),Object.defineProperty(a,"Stack",{get:sj_df(k,a,o,n,h)}),v<f&&(p=JSON.stringify(a),y=!1,n===t.Error?(console.error(p)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                taSourceLayoutManager||(DataSourceLayoutManager={}));_w.DsLManager=DataSourceLayoutManager;ThresholdDiagnosticsProd=function(){function n(){this.debugStrings=[];sj_evt.bind("ajax.feedback.initialized",sj_dm(this,this.registerFeedbackDebugCallback),!0);sj_evt.bind("ajax.threshold.pageStart",sj_dm(this,this.clearDebugStrings))}return n.prototype.recordApiString=function(n){console.log(n);this.debugStrings.push(n)},n.prototype.clearDebugStrings=function(){this.debugStrings.length=0},n.prototype.collectDebugInfo=function(n){var t={};return n&&(t.apiDebug=this.debugStrings.toString()),t},n.prototype.registerFeedbackDebugCallback=function(n){var t=n[1].debugCollector;t.registerCollectionCallback(sj_dm(this,this.collectDebugInfo))},n}();_w.ThresholdDiagnostics=new ThresholdDiagnosticsProd;FailedPromise=function(){function n(){this.isActive=!0;this.operation=null}return n.prototype.then=function(n,t){return this.handleError(t),this},n.prototype.done=function(n,t){this.handleError(t)},n.prototype.handleError=function(n){this.isActive&&n&&_w.setImmediate(function(){return n(null)})},n.prototype.cancel=function(){this.isActive=!1},n}();ThresholdUtilitiesM2=function(){function n(){this.regExes={};this.guidCleaner=/[-{}]/g;this.isFirstPageStart=!0;this.startTime=_w.performance?_w.performance.timing.navigationStart:si_ST;this.apiSequenceNumber=0;this.headersAsyncPromise=null;this.headersCallComplete=!1;this.cortanaHeaders=null;this.themeColor=null;this.isDarkTheme=null;this.headersCallTimeout=3e3;this.headersCallbacks=[];this.rtlLangs=["ar","dv","fa","he","ku-arab","pa-arab","prs","ps","sd-arab","syr","ug","ur","qps-plocm"];sj_evt.bind("ajax.threshold.authChanged",sj_dm(this,this.clearLocalCache),1);sj_evt.bind("ajax.threshold.pageStart",sj_dm(this,this.onPageStart),1)}return n.prototype.getUrlParameter=function(n,t){for(var r=null,f=this.getParameterRegex(t),u,i;u=f.exec(n);)i=u;return i&&i.length>=2?r=i[1]:t==="mock"&&(r=this.getMockParameter(n)),r},n.prototype.setUrlParameter=function(n,t,i){var r=n,u=this.getParameterRegex(t).exec(n),f="&",e,o,s;return u?(f=u[0].substring(0,1),e=u.index,o=u.index+u[0].length,r=n.substring(0,e),i&&(r+=f+t+"="+i),r+=n.substring(o)):i&&(s=this.getRegex("devicecontent"),s.test(n)?n.indexOf("#")<0&&(f="#"):n.indexOf("?")<0&&(f="?"),r=n+f+t+"="+i),r},n.prototype.getDecodedQuery=function(n){var i=n,t;return i||(i=_w.location.href),t=this.getUrlParameter(i,"q"),t&&(t=decodeURIComponent(t.replace(this.getRegex("\\+")," ")).trim()),t},n.prototype.getUrlReadyQuery=function(n){return encodeURIComponent(n).replace(this.getRegex("%20"),"+")},n.prototype.recordApiTimeDetail=function(n,t,i){var u=new Date,f,r,e,o;if(n&&(_G.ApiTimes=_G.ApiTimes||{},_G.ApiTimes[n]=u.getTime()-this.startTime),i){f={};for(r in i)i.hasOwnProperty(r)&&(f[r]=i[r]);i=f;i.time=u}else i={time:u,label:n||t,sequence:this.apiSequenceNumber++};return e=_w.msWriteProfilerMark,o=i.sequence+","+(n||i.label),e&&e(o),_w.performance&&performance.mark&&performance.mark(o),i},n.prototype.recordApiTime=function(n){return this.recordApiTimeDetail(n),null},n.prototype.uploadApiTimes=function(n){var t=_G.ApiTimes;this.recordApiTime(n);t&&typeof Log2!="undefined"&&Log2&&(Log2.LogEvent("CPT2",{wt:t},null,null,null,null,null,null),_G.ApiTimes={})},n.prototype.wrapSynchronousApiCall=function(n,t,i,r){for(var e,o,s,h=this,f=[],u=4;u<arguments.length;u++)f[u-4]=arguments[u];e=this.recordApiTimeDetail(i?i+"S":null,t);s=function(n,u){var o=h.recordApiTimeDetail(i?i+n:null,t,e),s=u?" exception: "+u.stack:"";h.recordApiString("ApiEnd "+n+' \t"'+(r?r:"")+'"\t'+t+"("+f.join(", ")+")\t"+(o.time.getTime()-e.time.getTime())+"ms elapsed"+s)};try{o=n[t].apply(n,f);s("C")}catch(c){s("E",c);SharedLogHelper.LogError("Exception","Failed while calling overrideMethod: "+t,c);o=null}return o},n.prototype.wrapApiCall=function(){for(var i,n=[],t=4;t<arguments.length;t++)n[t-4]=arguments[t];for(n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);return n.splice(4,0,0,null),this.wrapApiCallWithTimeout.apply(this,n)},n.prototype.wrapApiCallWithTimeout=function(n,t,i,r,u,f){for(var y,s=[],h=6;h<arguments.length;h++)s[h-6]=arguments[h];if(_w.SearchAppWrapperLogging)return n[t].apply(n,s);var l=this,a=this.recordApiTimeDetail(i?i+"S":null,t),e,o,c=function(n,u){var e="stack",o=l.recordApiTimeDetail(i?i+n:null,t,a),f=u&&u[e]?" exception: "+u[e]:"";u&&f===""&&(f=" Windows error: "+u.message);l.recordApiString("ApiEnd "+n+' \t"'+(r?r:"")+'"\t'+t+"("+s.join(", ")+")\t"+(o.time.getTime()-a.time.getTime())+"ms elapsed"+f)};try{o=n[t].apply(n,s);this.recordApiTimeDetail(i?i+"P":null,t);u&&u>0&&(e=sb_st(function(){o&&o.cancel&&o.cancel();c("T");f&&f(null)},u));o.then(function(n){return e&&sb_ct(e),c("C"),n},function(n){e&&sb_ct(e);c("E",n);SharedLogHelper.LogError("Exception","Failed in overrideMethod callback: "+t,n);f&&f(null)})}catch(v){e&&sb_ct(e);c("E",v);SharedLogHelper.LogError("Exception","Failed while calling overrideMethod: "+t,v);y=new FailedPromise;o=y.then(null,f)}return o},n.prototype.cleanGuid=function(n){var t=n;return t&&(t=t.replace(this.guidCleaner,"")),t},n.prototype.parseJSON=function(n){var t,i=null;if(n)try{t=JSON.parse(n)}catch(r){i=r}return t||console.log("Unable to parse JSON input: "+n+(i?".  Exception: "+i:"")),t},n.prototype.getCortanaHeaders=function(n){var f=this,t=this;if(this.headersCallComplete){n(this.cortanaHeaders);return}if(this.headersCallbacks.push(n),!this.headersAsyncPromise){var i=null,e=!1,u=function(){i&&(sb_ct(i),i=null);t.headersCallComplete=!0},r=function(){var i,r,n;if(!e)for(t.cortanaHeaders||(t.cortanaHeadersTimedOut?SharedLogHelper.LogWarning("getCortanaHeaders",null,"Timeout"):SharedLogHelper.LogError("getCortanaHeaders",null,t.cortanaHeadersError||new Error("Missing headers"))),i=t.headersCallbacks,r=i.length,n=0;n<r;n++)i[n](t.cortanaHeaders)},s=function(n){u();var i={};try{Object.keys(n).forEach(function(t){n[t]&&(i[t]=n[t].toString())})}catch(e){SharedLogHelper.LogError("getCortanaHeaders","copy headers failed. ".concat(e))}try{f.headerOverrides(i);t.cortanaHeaders=i;t.cortanaHeadersError=null;t.cortanaHeadersTimedOut=!1;r()}catch(e){SharedLogHelper.LogError("getCortanaHeaders","getCortanaHeaders callback failed. ".concat(e),e)}},h=function(n){try{u();f.headerOverrides(n);t.cortanaHeaders=n;t.cortanaHeadersError=null;t.cortanaHeadersTimedOut=!1;r()}catch(i){SharedLogHelper.LogError("getCortanaHeaders","getQueryHeadersJsonStringAsync callback failed. ".concat(i))}},o=function(n){u();t.cortanaHeaders=null;t.cortanaHeadersError=n;t.cortanaHeadersTimedOut=!1;r()};i=sb_st(function(){t.cortanaHeaders=null;t.cortanaHeadersError=null;t.cortanaHeadersTimedOut=!0;r();e=!0},this.headersCallTimeout);this.headersAsyncPromise=_w.WSB&&!!WSB.config&&WSB.config.wsbWebView2&&SearchAppWrapper.CortanaApp.webRequestHelper?this.wrapApiCall(SearchAppWrapper.CortanaApp.webRequestHelper,"getQueryHeadersJsonStringAsync","GQH_","getQueryHeadersJsonString").then(function(n){return h(JSON.parse(n))},o):this.wrapApiCall(SearchAppWrapper.CortanaApp,"getQueryHeadersAsync","GQH_","getQueryHeaders").then(s,o)}},n.prototype.headerOverrides=function(n){var t=SearchAppWrapper.CortanaApp.width,i=SearchAppWrapper.CortanaApp.height,r;t&&i&&(n["X-BM-DeviceDimensionsLogical"]=t+"x"+i,r=SearchAppWrapper.CortanaApp.deviceScale,r!=100&&(t=t*r/100,i=i*r/100),n["X-BM-DeviceDimensions"]=t+"x"+i);_w.WSB&&!!WSB.config&&(delete n["X-Search-RPSToken"],delete n.Authorization)},n.prototype.getThemeColor=function(n){function u(n){var t,r;i.themeColor===null&&n&&(t=n.split(";"),t.length==2&&(i.isDarkTheme=t[0]=="000000",r=t[1],r&&(i.themeColor="#"+r)))}var t=this,i=this,r;this.themeColor===null?(r=SearchAppWrapper.CortanaApp.theme,typeof r!="undefined"?(u(r),n(this.themeColor,this.isDarkTheme)):this.getCortanaHeaders(function(i){t.themeColor===null&&i&&(u(i["X-BM-Theme"]),n(t.themeColor,t.isDarkTheme))})):n(this.themeColor,this.isDarkTheme)},n.prototype.getOsSKU=function(n){var t="X-Device-OSSKU";this.getCortanaHeaders(function(i){i&&i[t]?n(i[t]):n("unknown")})},n.prototype.isRightToLeftLanguage=function(n){return this.rtlLangs.some(function(t){return n=n.toLocaleLowerCase(),n==t||n.indexOf(t+"-")==0})},n.prototype.setBodyLangAttributes=function(n){_d.body.setAttribute("dir",this.isRightToLeftLanguage(n)?"rtl":"ltr");_d.body.setAttribute("lang",n)},n.prototype.recordApiString=function(n){ThresholdDiagnostics.recordApiString(n)},n.prototype.pushOntoArray=function(n,t){if(n&&t)for(var i in t)n.push(t[i])},n.prototype.navigateTo=function(n,t){var i=sj_ce("a","b_hide");i.href=n;i.setAttribute("data-h",t.GetNamespacedKValue());_d.body.appendChild(i);i.click()},n.prototype.createPromise=function(n){return Promise.promise?Promise.promise(n):new Promise(n)},n.prototype.getParameterRegex=function(n){return this.getRegex("[?&#]"+n.toLowerCase()+"=([^&#]*)")},n.prototype.getRegex=function(n,t,i){var r=this.regExes[n];return r||(r=new RegExp(n,(i?"":"g")+(t?"":"i")),this.regExes[n]=r),r.lastIndex=0,r},n.prototype.getMockParameter=function(n){var r=null,t=n.indexOf("#"),u,i;return t>0&&t<n.length-1&&(u=n.substr(t+1).split("&"),i=u.filter(this.unlabeledParameterFilter),i.length>0&&(r=i[0])),r},n.prototype.unlabeledParameterFilter=function(n){return n.indexOf("=")<0},n.prototype.clearLocalCache=function(){this.cortanaHeaders=null;this.cortanaHeadersError=null;this.cortanaHeadersTimedOut=!1;this.themeColor=null;this.headersAsyncPromise=null;this.headersCallComplete=!1;this.headersCallbacks=[]},n.prototype.onPageStart=function(n){!this.isFirstPageStart&&n[1]&&(this.startTime=n[1],this.clearLocalCache());this.isFirstPageStart=!1;sj_evt.fire("ajax.postload")},n}();_w.ThresholdUtilities=new ThresholdUtilitiesM2;sj_evt.bind("threshold.pageUnload",function(){sj_evt.fire("unload")},0);_w.ClientInstConfig||(_w.ClientInstConfig={});ClientInstConfig.enableOfflineBundleWithWebExperience=!1;_w.ClientInstConfig||(_w.ClientInstConfig={});ClientInstConfig.maxBatchSize=37e4